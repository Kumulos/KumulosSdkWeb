/*! For license information please see index.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.kumulos=t():e.kumulos=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return I})),n.d(t,"hydrate",(function(){return j})),n.d(t,"createElement",(function(){return v})),n.d(t,"h",(function(){return v})),n.d(t,"Fragment",(function(){return b})),n.d(t,"createRef",(function(){return y})),n.d(t,"isValidElement",(function(){return o})),n.d(t,"Component",(function(){return _})),n.d(t,"cloneElement",(function(){return D})),n.d(t,"createContext",(function(){return F})),n.d(t,"toChildArray",(function(){return P})),n.d(t,"_unmount",(function(){return N})),n.d(t,"options",(function(){return r}));var r,o,i,u,s,a,c,l={},p=[],f=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function d(e,t){for(var n in t)e[n]=t[n];return e}function h(e){var t=e.parentNode;t&&t.removeChild(e)}function v(e,t,n){var r,o=arguments,i={};for(r in t)"key"!==r&&"ref"!==r&&(i[r]=t[r]);if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(o[r]);if(null!=n&&(i.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===i[r]&&(i[r]=e.defaultProps[r]);return m(e,i,t&&t.key,t&&t.ref)}function m(e,t,n,o){var i={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0};return r.vnode&&r.vnode(i),i}function y(){return{}}function b(e){return e.children}function _(e,t){this.props=e,this.context=t}function g(e,t){if(null==t)return e.__?g(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?g(e):null}function k(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return k(e)}}function w(e){(!e.__d&&(e.__d=!0)&&1===i.push(e)||s!==r.debounceRendering)&&((s=r.debounceRendering)||u)(x)}function x(){var e,t,n,r,o,u,s;for(i.sort((function(e,t){return t.__v.__b-e.__v.__b}));e=i.pop();)e.__d&&(n=void 0,r=void 0,u=(o=(t=e).__v).__e,(s=t.__P)&&(n=[],r=R(s,o,d({},o),t.__n,void 0!==s.ownerSVGElement,null,n,null==u?g(o):u),M(n,o),r!=u&&k(o)))}function S(e,t,n,r,o,i,u,s,a){var c,f,d,v,m,y,b,_=n&&n.__k||p,k=_.length;if(s==l&&(s=null!=i?i[0]:k?g(n,0):null),c=0,t.__k=P(t.__k,(function(n){if(null!=n){if(n.__=t,n.__b=t.__b+1,null===(d=_[c])||d&&n.key==d.key&&n.type===d.type)_[c]=void 0;else for(f=0;f<k;f++){if((d=_[f])&&n.key==d.key&&n.type===d.type){_[f]=void 0;break}d=null}if(v=R(e,n,d=d||l,r,o,i,u,s,a),(f=n.ref)&&d.ref!=f&&(b||(b=[]),d.ref&&b.push(d.ref,null,n),b.push(f,n.__c||v,n)),null!=v){var p;if(null==y&&(y=v),void 0!==n.__d)p=n.__d,n.__d=void 0;else if(i==d||v!=s||null==v.parentNode){e:if(null==s||s.parentNode!==e)e.appendChild(v),p=null;else{for(m=s,f=0;(m=m.nextSibling)&&f<k;f+=2)if(m==v)break e;e.insertBefore(v,s),p=s}"option"==t.type&&(e.value="")}s=void 0!==p?p:v.nextSibling,"function"==typeof t.type&&(t.__d=s)}}return c++,n})),t.__e=y,null!=i&&"function"!=typeof t.type)for(c=i.length;c--;)null!=i[c]&&h(i[c]);for(c=k;c--;)null!=_[c]&&N(_[c],_[c]);if(b)for(c=0;c<b.length;c++)A(b[c],b[++c],b[++c])}function P(e,t,n){if(null==n&&(n=[]),null==e||"boolean"==typeof e)t&&n.push(t(null));else if(Array.isArray(e))for(var r=0;r<e.length;r++)P(e[r],t,n);else n.push(t?t("string"==typeof e||"number"==typeof e?m(null,e,null,null):null!=e.__e||null!=e.__c?m(e.type,e.props,e.key,null):e):e);return n}function C(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]="number"==typeof n&&!1===f.test(t)?n+"px":null==n?"":n}function E(e,t,n,r,o){var i,u,s,a,c;if(o?"className"===t&&(t="class"):"class"===t&&(t="className"),"key"===t||"children"===t);else if("style"===t)if(i=e.style,"string"==typeof n)i.cssText=n;else{if("string"==typeof r&&(i.cssText="",r=null),r)for(u in r)n&&u in n||C(i,u,"");if(n)for(s in n)r&&n[s]===r[s]||C(i,s,n[s])}else"o"===t[0]&&"n"===t[1]?(a=t!==(t=t.replace(/Capture$/,"")),c=t.toLowerCase(),t=(c in e?c:t).slice(2),n?(r||e.addEventListener(t,O,a),(e.l||(e.l={}))[t]=n):e.removeEventListener(t,O,a)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n?e.removeAttribute(t):e.setAttribute(t,n))}function O(e){this.l[e.type](r.event?r.event(e):e)}function R(e,t,n,o,i,u,s,a,c){var l,p,f,h,v,m,y,g,k,w,x=t.type;if(void 0!==t.constructor)return null;(l=r.__b)&&l(t);try{e:if("function"==typeof x){if(g=t.props,k=(l=x.contextType)&&o[l.__c],w=l?k?k.props.value:l.__:o,n.__c?y=(p=t.__c=n.__c).__=p.__E:("prototype"in x&&x.prototype.render?t.__c=p=new x(g,w):(t.__c=p=new _(g,w),p.constructor=x,p.render=U),k&&k.sub(p),p.props=g,p.state||(p.state={}),p.context=w,p.__n=o,f=p.__d=!0,p.__h=[]),null==p.__s&&(p.__s=p.state),null!=x.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=d({},p.__s)),d(p.__s,x.getDerivedStateFromProps(g,p.__s))),h=p.props,v=p.state,f)null==x.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==x.getDerivedStateFromProps&&g!==h&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(g,w),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(g,p.__s,w)){for(p.props=g,p.state=p.__s,p.__d=!1,p.__v=t,t.__e=n.__e,t.__k=n.__k,p.__h.length&&s.push(p),l=0;l<t.__k.length;l++)t.__k[l]&&(t.__k[l].__=t);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(g,p.__s,w),null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(h,v,m)}))}p.context=w,p.props=g,p.state=p.__s,(l=r.__r)&&l(t),p.__d=!1,p.__v=t,p.__P=e,l=p.render(p.props,p.state,p.context),t.__k=null!=l&&l.type==b&&null==l.key?l.props.children:l,null!=p.getChildContext&&(o=d(d({},o),p.getChildContext())),f||null==p.getSnapshotBeforeUpdate||(m=p.getSnapshotBeforeUpdate(h,v)),S(e,t,n,o,i,u,s,a,c),p.base=t.__e,p.__h.length&&s.push(p),y&&(p.__E=p.__=null),p.__e=!1}else t.__e=T(n.__e,t,n,o,i,u,s,c);(l=r.diffed)&&l(t)}catch(e){r.__e(e,t,n)}return t.__e}function M(e,t){r.__c&&r.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){r.__e(e,t.__v)}}))}function T(e,t,n,r,o,i,u,s){var a,c,f,d,h,v=n.props,m=t.props;if(o="svg"===t.type||o,null==e&&null!=i)for(a=0;a<i.length;a++)if(null!=(c=i[a])&&(null===t.type?3===c.nodeType:c.localName===t.type)){e=c,i[a]=null;break}if(null==e){if(null===t.type)return document.createTextNode(m);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,m.is&&{is:m.is}),i=null}if(null===t.type)null!=i&&(i[i.indexOf(e)]=null),v!==m&&e.data!=m&&(e.data=m);else if(t!==n){if(null!=i&&(i[i.indexOf(e)]=null,i=p.slice.call(e.childNodes)),f=(v=n.props||l).dangerouslySetInnerHTML,d=m.dangerouslySetInnerHTML,!s){if(v===l)for(v={},h=0;h<e.attributes.length;h++)v[e.attributes[h].name]=e.attributes[h].value;(d||f)&&(d&&f&&d.__html==f.__html||(e.innerHTML=d&&d.__html||""))}(function(e,t,n,r,o){var i;for(i in n)i in t||E(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"value"===i||"checked"===i||n[i]===t[i]||E(e,i,t[i],n[i],r)})(e,m,v,o,s),t.__k=t.props.children,d||S(e,t,n,r,"foreignObject"!==t.type&&o,i,u,l,s),s||("value"in m&&void 0!==m.value&&m.value!==e.value&&(e.value=null==m.value?"":m.value),"checked"in m&&void 0!==m.checked&&m.checked!==e.checked&&(e.checked=m.checked))}return e}function A(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,n)}}function N(e,t,n){var o,i,u;if(r.unmount&&r.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||A(o,null,t)),n||"function"==typeof e.type||(n=null!=(i=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){r.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(u=0;u<o.length;u++)o[u]&&N(o[u],t,n);null!=i&&h(i)}function U(e,t,n){return this.constructor(e,n)}function I(e,t,n){var o,i,u;r.__&&r.__(e,t),i=(o=n===a)?null:n&&n.__k||t.__k,e=v(b,null,[e]),u=[],R(t,(o?t:n||t).__k=e,i||l,l,void 0!==t.ownerSVGElement,n&&!o?[n]:i?null:p.slice.call(t.childNodes),u,n||l,o),M(u,e)}function j(e,t){I(e,t,a)}function D(e,t){return t=d(d({},e.props),t),arguments.length>2&&(t.children=p.slice.call(arguments,2)),m(e.type,t,t.key||e.key,t.ref||e.ref)}function F(e){var t={},n={__c:"__cC"+c++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var r,o=this;return this.getChildContext||(r=[],this.getChildContext=function(){return t[n.__c]=o,t},this.shouldComponentUpdate=function(t){e.value!==t.value&&r.some((function(e){e.context=t.value,w(e)}))},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Consumer.contextType=n,n}r={__e:function(e,t){for(var n,r;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(r=!0,n.setState(n.constructor.getDerivedStateFromError(e))),null!=n.componentDidCatch&&(r=!0,n.componentDidCatch(e)),r)return w(n.__E=n)}catch(t){e=t}throw e}},o=function(e){return null!=e&&void 0===e.constructor},_.prototype.setState=function(e,t){var n;n=this.__s!==this.state?this.__s:this.__s=d({},this.state),"function"==typeof e&&(e=e(n,this.props)),e&&d(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),w(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),w(this))},_.prototype.render=b,i=[],u="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,a=l,c=0},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){for(var e=navigator.userAgent.toLowerCase(),t=0,n=["edge","firefox","chrome","safari"];t<n.length;t++){var r=n[t];if(e.indexOf(r)>-1)return r}return""}t.__esModule=!0,t.parseQueryString=t.defer=t.registerServiceWorker=t.base64UrlEncode=t.authedFetchJson=t.authedFetch=t.escapeRegExp=t.cyrb53=t.isBrowserSupported=t.getBrowserName=t.uuidv4=void 0,t.uuidv4=function(){return"undefined"==typeof crypto?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})):(1e7.toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(Number(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16)}))},t.getBrowserName=o,t.isBrowserSupported=function(){var e,t=[typeof Promise,typeof fetch,typeof indexedDB];return"safari"===o()?t.push(typeof(null===(e=window.safari)||void 0===e?void 0:e.pushNotification)):t.push.apply(t,[typeof Notification,typeof navigator.serviceWorker,typeof PushManager]),t.reduce((function(e,t){return e&&"undefined"!==t}),!0)};var i=Math.imul||function(e,t){var n=(4194303&e)*(t|=0);return 4290772992&e&&(n+=(4290772992&e)*t|0),0|n};function u(e,t,n){var o;void 0===n&&(n={method:"GET"});var i=null!==(o=n.headers)&&void 0!==o?o:{};return n.headers=r({"Content-Type":"application/json",Accept:"application/json",Authorization:e.authHeader},i),fetch(t,n)}t.cyrb53=function(e,t){void 0===t&&(t=0);for(var n=3735928559^t,r=1103547991^t,o=0,u=void 0;o<e.length;o++)u=e.charCodeAt(o),n=i(n^u,2654435761),r=i(r^u,1597334677);return n=i(n^n>>>16,2246822507)^i(r^r>>>13,3266489909),4294967296*(2097151&(r=i(r^r>>>16,2246822507)^i(n^n>>>13,3266489909)))+(n>>>0)},t.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},t.authedFetch=u,t.authedFetchJson=function(e,t,n){return u(e,t,n).then((function(e){return e.json()}))},t.base64UrlEncode=function(e){var t=new Uint8Array(e);return btoa(t.reduce((function(e,t){return e+String.fromCharCode(t)}),"")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},t.registerServiceWorker=function(e){return"serviceWorker"in navigator?navigator.serviceWorker.register(e).then((function(){return navigator.serviceWorker.ready})):Promise.reject("ServiceWorker is not supported in this browser, aborting...")},t.defer=function(){var e={resolve:null,reject:null,promise:null};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e},t.parseQueryString=function(e,t){void 0===e&&(e=location.search),void 0===t&&(t=[]);var n=void 0;return e.length>0&&(n=e.substring(1).split("&").map((function(e){return e.split("=")})).map((function(e){return e.map(decodeURIComponent)})).filter((function(e){return-1===t.indexOf(e[0])})).reduce((function(e,t){var n;return r(r({},e),((n={})[t[0]]=t[1],n))}),{})),n}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0,t.trackInstallDetails=t.trackEvent=t.clearUserAssociation=t.associateUser=t.getUserId=t.getInstallId=t.assertConfigValid=t.Context=t.EventType=t.PUSH_BASE_URL=void 0;var i,u=n(1),s=n(3),a="1.5.2";t.PUSH_BASE_URL="https://push.kumulos.com",function(e){e.MESSAGE_DELIVERED="k.message.delivered",e.MESSAGE_OPENED="k.message.opened",e.PUSH_REGISTERED="k.push.deviceRegistered",e.INSTALL_TRACKED="k.stats.installTracked",e.USER_ASSOCIATED="k.stats.userAssociated",e.USER_ASSOCIATION_CLEARED="k.stats.userAssociationCleared",e.PAGE_VIEWED="k.pageViewed"}(i=t.EventType||(t.EventType={}));var c=function(){function e(e){var t,n,r;this.apiKey=e.apiKey,this.secretKey=e.secretKey,this.vapidPublicKey=e.vapidPublicKey,this.authHeader="Basic "+btoa(this.apiKey+":"+this.secretKey),this.serviceWorkerPath=null!==(t=e.serviceWorkerPath)&&void 0!==t?t:"/worker.js",this.pushPrompts=null!==(n=e.pushPrompts)&&void 0!==n?n:"auto",this.autoResubscribe=null===(r=e.autoResubscribe)||void 0===r||r,this.subscribers={}}return e.prototype.subscribe=function(e,t){this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].indexOf(t)>-1||this.subscribers[e].push(t)},e.prototype.broadcast=function(e,t){if(this.subscribers[e])for(var n=0;n<this.subscribers[e].length;++n)this.subscribers[e][n]({type:e,data:t})},e}();t.Context=c,t.assertConfigValid=function(e){if("object"!=typeof e)throw"Config must be an object";for(var t=0,n=["apiKey","secretKey","vapidPublicKey"];t<n.length;t++){var r=n[t];if("string"!=typeof e[r]||0===e[r].length)throw"Required configuration key '"+r+"' must be non-empty string"}if(e.serviceWorkerPath&&"string"!=typeof e.serviceWorkerPath&&0===e.serviceWorkerPath.length)throw"Optional configuration key 'serviceWorkerPath' must be non-empty string (if supplied)";if(e.onPushReceived&&"function"!=typeof e.onPushReceived)throw"Optional configuration key 'onPushReceived' must be a function";if(e.onPushOpened&&"function"!=typeof e.onPushOpened)throw"Optional configuration key 'onPushOpened' must be a function"};var l=void 0;function p(){return l||(l=s.get("installId").then((function(e){return e||s.set("installId",u.uuidv4())})))}function f(){return s.get("userId").then((function(e){return null!=e?e:p()}))}function d(e,t,n){return r(this,void 0,void 0,(function(){var r,i,s,a;return o(this,(function(o){switch(o.label){case 0:return[4,p()];case 1:return r=o.sent(),[4,f()];case 2:return i=o.sent(),s=[{type:t,uuid:u.uuidv4(),timestamp:Date.now(),data:n,userId:i}],a="https://events.kumulos.com/v1/app-installs/"+r+"/events",e.broadcast("eventTracked",s),[2,u.authedFetch(e,a,{method:"POST",body:JSON.stringify(s)})]}}))}))}t.getInstallId=p,t.getUserId=f,t.associateUser=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,s.set("userId",t)];case 1:return o.sent(),r={id:t,attributes:n},[2,d(e,i.USER_ASSOCIATED,r).then((function(e){}))]}}))}))},t.clearUserAssociation=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,f()];case 1:return t=n.sent(),d(e,i.USER_ASSOCIATION_CLEARED,{oldUserIdentifier:t}),[2,s.del("userId")]}}))}))},t.trackEvent=d,t.trackInstallDetails=function(e){return r(this,void 0,void 0,(function(){var t,n,r,c;return o(this,(function(o){switch(o.label){case 0:t={app:{bundle:location.host,version:"0.0.0",target:2},sdk:{id:10,version:a},runtime:{id:8,version:navigator.userAgent},os:{id:0,version:"0.0.0"},device:{name:navigator.userAgent,tz:"undefined"!=typeof Intl&&Intl.DateTimeFormat().resolvedOptions().timeZone||null,isSimulator:!1,locale:navigator.language}},n=[a,t.app.bundle,t.device.tz,t.device.locale,t.device.name],r=u.cyrb53(n.join("|")),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.get("detailsHash")];case 2:return o.sent()===r?[2,Promise.resolve()]:[3,4];case 3:return c=o.sent(),[2,Promise.reject(c)];case 4:return[2,d(e,i.INSTALL_TRACKED,t).then((function(){return s.set("detailsHash",r)})).then((function(){}))]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0,t.getMostRecentlyOpenedPushPayload=t.persistOpenedPushPayload=t.getContextFromStoredConfig=t.persistConfig=t.del=t.set=t.get=void 0;var i=n(2),u=n(9),s=new u.Store("kumulos","default");function a(e){return u.get(e,s)}function c(e,t){return u.set(e,t,s).then((function(){return t}))}function l(e){return u.del(e,s)}t.get=a,t.set=c,t.del=l,t.persistConfig=function(e){return c("config",{apiKey:e.apiKey,secretKey:e.secretKey,vapidPublicKey:e.vapidPublicKey,serviceWorkerPath:e.serviceWorkerPath,autoResubscribe:e.autoResubscribe,pushPrompts:e.pushPrompts})},t.getContextFromStoredConfig=function(){return a("config").then((function(e){return e?new i.Context(e):void 0}))},t.persistOpenedPushPayload=function(e){return c("mostRecentOpenedPushPayload",e)},t.getMostRecentlyOpenedPushPayload=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,a("mostRecentOpenedPushPayload")];case 1:return e=t.sent(),[4,l("mostRecentOpenedPushPayload")];case 2:return t.sent(),[2,null!=e?e:void 0]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.notificationFromPayload=t.trackOpenFromQuery=t.MessageType=t.TokenType=void 0;var i,u,s=n(2),a=n(1),c=o(n(11)),l=o(n(12)),p=n(5);!function(e){e[e.W3C=3]="W3C",e[e.SAFARI=4]="SAFARI"}(t.TokenType||(t.TokenType={})),function(e){e[e.PUSH=1]="PUSH"}(i=t.MessageType||(t.MessageType={})),t.default=function(e){if(u)return u;var t=a.getBrowserName();return u="safari"===t?p.loadConfig(e).then((function(e){return new c.default(e)})):Promise.resolve(new l.default)},t.trackOpenFromQuery=function(e){if("safari"===a.getBrowserName()){var t=a.parseQueryString();(null==t?void 0:t.knid)&&s.trackEvent(e,s.EventType.MESSAGE_OPENED,{type:i.PUSH,id:Number(t.knid)})}},t.notificationFromPayload=function(e){var t,n,o,i=r({},e.data);return delete i["k.message"],{id:e.data["k.message"].data.id,title:e.title,message:e.msg,data:i,url:null!==(t=e.url)&&void 0!==t?t:void 0,iconUrl:null!==(n=e.icon)&&void 0!==n?n:void 0,imageUrl:null!==(o=e.image)&&void 0!==o?o:void 0}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0,t.loadConfig=void 0;var i=n(2),u=n(3),s=n(1);t.loadConfig=function(e){var t,n;return r(this,void 0,void 0,(function(){var r,a,c,l,p,f;return o(this,(function(o){switch(o.label){case 0:return[4,u.get("platformConfig")];case 1:return r=null!==(t=o.sent())&&void 0!==t?t:{},a=36e5,[4,u.get("platformConfigUpdated")];case 2:if(c=null!==(n=o.sent())&&void 0!==n?n:0,l=!1,!(Date.now()-c>a))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),p=i.PUSH_BASE_URL+"/v1/web/config",[4,s.authedFetchJson(e,p)];case 4:return r=o.sent(),l=!0,[3,6];case 5:return f=o.sent(),console.warn(f),[3,6];case 6:return l?[4,u.set("platformConfig",r)]:[3,9];case 7:return o.sent(),[4,u.set("platformConfigUpdated",Date.now())];case 8:o.sent(),o.label=9;case 9:return[2,r]}}))}))}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(u=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(u)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(a," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(i).concat([o]).join("\n")}var u,s,a;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r=0;r<e.length;r++){var o=[].concat(e[r]);n&&(o[2]?o[2]="".concat(n," and ").concat(o[2]):o[2]=n),t.push(o)}},t}},function(e,t,n){"use strict";var r,o={},i=function(){return"undefined"==typeof r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},u=function(){var e={};return function(t){if("undefined"==typeof e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function s(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],u=t.base?i[0]+t.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};r[u]?r[u].parts.push(s):n.push(r[u]={id:u,parts:[s]})}return n}function a(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id],u=0;if(i){for(i.refs++;u<i.parts.length;u++)i.parts[u](r.parts[u]);for(;u<r.parts.length;u++)i.parts.push(m(r.parts[u],t))}else{for(var s=[];u<r.parts.length;u++)s.push(m(r.parts[u],t));o[r.id]={id:r.id,refs:1,parts:s}}}}function c(e){var t=document.createElement("style");if("undefined"==typeof e.attributes.nonce){var r=n.nc;r&&(e.attributes.nonce=r)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var o=u(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,p=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=p(t,o);else{var i=document.createTextNode(o),u=e.childNodes;u[t]&&e.removeChild(u[t]),u.length?e.insertBefore(i,u[t]):e.appendChild(i)}}function d(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o&&e.setAttribute("media",o),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,v=0;function m(e,t){var n,r,o;if(t.singleton){var i=v++;n=h||(h=c(t)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else n=c(t),r=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=s(e,t);return a(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var u=n[i],c=o[u.id];c&&(c.refs--,r.push(c))}e&&a(s(e,t),t);for(var l=0;l<r.length;l++){var p=r[l];if(0===p.refs){for(var f=0;f<p.parts.length;f++)p.parts[f]();delete o[p.id]}}}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0;var a=n(2),c=n(10),l=n(3),p=i(n(4)),f=n(13),d=n(14),h=n(1),v=function(){function e(e){var t=this;this.onWorkerMessage=function(e){var n,r;if(e.origin===location.origin&&c.isKumulosWorkerMessage(e.data))switch(e.data.type){case c.WorkerMessageType.KPushReceived:var o=p.notificationFromPayload(e.data.data);null===(r=(n=t.config).onPushReceived)||void 0===r||r.call(n,o)}},a.assertConfigValid(e),this.config=e,this.context=new a.Context(e),l.persistConfig(e),a.trackInstallDetails(this.context),p.trackOpenFromQuery(this.context),this.serviceWorkerReg=h.registerServiceWorker(this.context.serviceWorkerPath),this.promptManager=new d.PromptManager(this,this.context),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",this.onWorkerMessage),this.maybeFireOpenedHandler()}return e.prototype.getInstallId=function(){return a.getInstallId()},e.prototype.getCurrentUserIdentifier=function(){return a.getUserId()},e.prototype.associateUser=function(e,t){return a.associateUser(this.context,e,t)},e.prototype.clearUserAssociation=function(){return a.clearUserAssociation(this.context)},e.prototype.trackEvent=function(e,t){return a.trackEvent(this.context,e,t).then((function(e){}))},e.prototype.pushRegister=function(){return u(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:return[4,p.default(this.context)];case 1:return[2,(e=n.sent()).requestNotificationPermission(this.context).then((function(e){if("granted"!==e)return Promise.reject("Notification permission not granted")})).then((function(){return e.pushRegister(t.context)}))]}}))}))},e.prototype.getChannelSubscriptionManager=function(){return this.channelSubscriptionManager||(this.channelSubscriptionManager=new f.ChannelSubscriptionManager(this.context)),this.channelSubscriptionManager},e.prototype.maybeFireOpenedHandler=function(){var e,t;return u(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,l.getMostRecentlyOpenedPushPayload()];case 1:return(n=o.sent())?(r=p.notificationFromPayload(n),null===(t=(e=this.config).onPushOpened)||void 0===t||t.call(e,r),[2]):[2]}}))}))},e}();t.default=v},function(e,t,n){"use strict";t.__esModule=!0,t.keys=t.clear=t.del=t.set=t.get=t.Store=void 0;var r,o=function(){function e(e,t){void 0===e&&(e="keyval-store"),void 0===t&&(t="keyval"),this.storeName=t,this._dbp=new Promise((function(n,r){var o=indexedDB.open(e,1);o.onerror=function(){return r(o.error)},o.onsuccess=function(){return n(o.result)},o.onupgradeneeded=function(){o.result.createObjectStore(t)}}))}return e.prototype._withIDBStore=function(e,t){var n=this;return this._dbp.then((function(r){return new Promise((function(o,i){var u=r.transaction(n.storeName,e);u.oncomplete=function(){return o()},u.onabort=u.onerror=function(){return i(u.error)},t(u.objectStore(n.storeName))}))}))},e}();function i(){return r||(r=new o),r}t.Store=o,t.get=function(e,t){var n;return void 0===t&&(t=i()),t._withIDBStore("readonly",(function(t){n=t.get(e)})).then((function(){return n.result}))},t.set=function(e,t,n){return void 0===n&&(n=i()),n._withIDBStore("readwrite",(function(n){n.put(t,e)}))},t.del=function(e,t){return void 0===t&&(t=i()),t._withIDBStore("readwrite",(function(t){t.delete(e)}))},t.clear=function(e){return void 0===e&&(e=i()),e._withIDBStore("readwrite",(function(e){e.clear()}))},t.keys=function(e){void 0===e&&(e=i());var t=[];return e._withIDBStore("readonly",(function(e){(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}})).then((function(){return t}))}},function(e,t,n){"use strict";var r;t.__esModule=!0,t.isKumulosWorkerMessage=t.WorkerMessageType=void 0,function(e){e.KPushReceived="KPushReceived"}(r=t.WorkerMessageType||(t.WorkerMessageType={})),t.isKumulosWorkerMessage=function(e){return void 0!==e.type&&void 0!==r[e.type]}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0;var i=n(2),u=n(4),s=n(1),a=n(3),c=n(5);function l(e,t){return s.cyrb53(e.apiKey+":"+t)}var p=function(){function e(e){this.cfg=e}return e.prototype.requestNotificationPermission=function(e){var t,n=i.PUSH_BASE_URL+"/safari/"+e.apiKey,r=s.defer();return null===(t=window.safari)||void 0===t||t.pushNotification.requestPermission(n,this.cfg.safariPushId,{},(function(e){r.resolve(e.permission)})),r.promise},e.prototype.pushRegister=function(e){var t;return r(this,void 0,void 0,(function(){var n,r,s,p;return o(this,(function(o){switch(o.label){case 0:return[4,c.loadConfig(e)];case 1:return n=o.sent(),(r=null===(t=window.safari)||void 0===t?void 0:t.pushNotification.permission(n.safariPushId))&&r.deviceToken?[4,a.get("pushTokenHash")]:[2];case 2:return s=o.sent(),p=l(e,r.deviceToken),s===p?[2]:[4,i.trackEvent(e,i.EventType.PUSH_REGISTERED,{type:u.TokenType.SAFARI,token:r.deviceToken,bundleId:n.safariPushId})];case 3:return o.sent(),[4,a.set("pushTokenHash",p)];case 4:return o.sent(),[2]}}))}))},e.prototype.requestPermissionAndRegisterForPush=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.requestNotificationPermission(e)];case 1:switch(t.sent()){case"default":return[2,"unsubscribed"];case"denied":return[2,"blocked"]}t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.pushRegister(e)];case 3:return t.sent(),[2,"subscribed"];case 4:return t.sent(),[2,"unsubscribed"];case 5:return[2]}}))}))},e.prototype.getCurrentSubscriptionState=function(e){var t,n;return r(this,void 0,void 0,(function(){var r,i,u,s;return o(this,(function(o){switch(o.label){case 0:return[4,c.loadConfig(e)];case 1:return r=o.sent(),(i=null===(t=window.safari)||void 0===t?void 0:t.pushNotification.permission(r.safariPushId))&&"denied"!==(null==i?void 0:i.permission)?[4,a.get("pushTokenHash")]:[2,"blocked"];case 2:return u=o.sent(),s=l(e,null!==(n=i.deviceToken)&&void 0!==n?n:""),u===s&&"granted"===i.permission?[2,"subscribed"]:[2,"unsubscribed"]}}))}))},e.prototype.handleAutoResubscription=function(e){var t;return r(this,void 0,void 0,(function(){var n,r,i,u;return o(this,(function(o){switch(o.label){case 0:return e.autoResubscribe&&this.cfg.safariPushId?[4,c.loadConfig(e)]:[2];case 1:return n=o.sent(),(r=null===(t=window.safari)||void 0===t?void 0:t.pushNotification.permission(n.safariPushId))&&"granted"===r.permission&&r.deviceToken?[4,a.get("pushTokenHash")]:[2];case 2:return i=o.sent(),u=l(e,r.deviceToken),i===u?[2]:[2,this.pushRegister(e)]}}))}))},e}();t.default=p},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0;var i=n(2),u=n(4),s=n(1),a=n(3);function c(e,t){var n=t.options.applicationServerKey;return!!n&&s.base64UrlEncode(n)===e}function l(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,navigator.serviceWorker.getRegistration()];case 1:return e.sent()?[2,navigator.serviceWorker.ready]:[2,Promise.reject("No service worker registration")]}}))}))}function p(e,t){return s.cyrb53(e.apiKey+":"+t.endpoint)}var f=function(){function e(){}return e.prototype.requestNotificationPermission=function(e){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:if("undefined"==typeof Notification)return[2,Promise.reject("Notifications are not supported in this browser, aborting...")];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Notification.requestPermission()];case 2:return[2,t.sent()];case 3:return e=t.sent(),console.error(e),[2,Promise.reject(e)];case 4:return[2]}}))}))},e.prototype.pushRegister=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,f,d,h;return o(this,(function(o){switch(o.label){case 0:return"PushManager"in window?[4,l()]:[2,Promise.reject("Push notifications are not supported in this browser")];case 1:return[4,(t=o.sent()).pushManager.getSubscription()];case 2:return!(n=o.sent())||c(e.vapidPublicKey,n)?[3,4]:[4,null==n?void 0:n.unsubscribe()];case 3:o.sent(),o.label=4;case 4:return[4,t.pushManager.subscribe({applicationServerKey:e.vapidPublicKey,userVisibleOnly:!0})];case 5:return r=o.sent(),s=p(e,r),f=r.expirationTime,[4,a.get("pushEndpointHash")];case 6:return d=o.sent(),[4,a.get("pushExpiresAt")];case 7:return h=o.sent(),d===s&&(!h||h>Date.now())?[2]:[4,i.trackEvent(e,i.EventType.PUSH_REGISTERED,{type:u.TokenType.W3C,token:r})];case 8:return o.sent(),[4,a.set("pushEndpointHash",s)];case 9:return o.sent(),[4,a.set("pushExpiresAt",f)];case 10:return o.sent(),[2]}}))}))},e.prototype.requestPermissionAndRegisterForPush=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.requestNotificationPermission(e)];case 1:switch(t.sent()){case"default":return[2,"unsubscribed"];case"denied":return[2,"blocked"]}t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.pushRegister(e)];case 3:return t.sent(),[2,"subscribed"];case 4:return t.sent(),[2,"unsubscribed"];case 5:return[2]}}))}))},e.prototype.getCurrentSubscriptionState=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return"denied"===(t=Notification.permission)?[2,"blocked"]:[4,l()];case 1:return[4,null==(n=o.sent())?void 0:n.pushManager.getSubscription()];case 2:return(r=o.sent())&&"granted"===t&&c(e.vapidPublicKey,r)?[2,"subscribed"]:[2,"unsubscribed"]}}))}))},e.prototype.handleAutoResubscription=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return e.autoResubscribe?"granted"!==Notification.permission?[2]:[4,a.get("pushEndpointHash")]:[2];case 1:return t=o.sent(),[4,a.get("pushExpiresAt")];case 2:return n=o.sent(),[4,l()];case 3:return[4,o.sent().pushManager.getSubscription()];case 4:if(r=o.sent(),i=void 0,r&&(i=p(e,r)),void 0!==t&&t===i&&r&&c(e.vapidPublicKey,r)&&(null==n||n>Date.now()))return[2];try{return[2,this.pushRegister(e)]}catch(e){console.error(e)}return[2]}}))}))},e}();t.default=f},function(e,t,n){"use strict";t.__esModule=!0,t.ChannelSubscriptionManager=void 0;var r=n(2),o=n(1),i=function(){function e(e){this.context=e}return e.prototype.makeSubscriptionRequest=function(e,t){var n=this;return r.getInstallId().then((function(i){var u=r.PUSH_BASE_URL+"/v1/app-installs/"+i+"/channels/subscriptions",s={uuids:t},a={method:e,body:JSON.stringify(s)};return o.authedFetch(n.context,u,a)}))},e.prototype.subscribe=function(e){return this.makeSubscriptionRequest("POST",e)},e.prototype.unsubscribe=function(e){return this.makeSubscriptionRequest("DELETE",e)},e.prototype.setSubscriptions=function(e){return this.makeSubscriptionRequest("PUT",e)},e.prototype.clearSubscriptions=function(){return this.setSubscriptions([])},e.prototype.listChannels=function(){var e=this;return r.getInstallId().then((function(t){var n=r.PUSH_BASE_URL+"/v1/app-installs/"+t+"/channels";return o.authedFetchJson(e.context,n)}))},e.prototype.createChannel=function(e){var t=this;return!e.showInPortal||e.name&&e.name.length?r.getInstallId().then((function(n){var i=r.PUSH_BASE_URL+"/v1/channels",u={uuid:e.uuid,name:e.name,showInPortal:Boolean(e.showInPortal),meta:e.meta,installId:void 0};e.subscribe&&(u.installId=n);var s={method:"POST",body:JSON.stringify(u)};return o.authedFetchJson(t.context,i,s)})):Promise.reject({error:"Name is required for channel creation when showInPortal is true"})},e}();t.ChannelSubscriptionManager=i},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.PromptManager=void 0;var s=u(n(4)),a=n(0),c=u(n(15)),l=n(20),p=n(21),f=function(){function e(e,t){var n=this;this.onEventTracked=function(e){var t,r=e.data;(t=n.eventQueue).push.apply(t,r),"ready"===n.state&&n.evaluateTriggers()},this.activateDeferredPrompt=function(e){n.activatePrompt(e),n.render()},this.onRequestNativePrompt=function(e){return o(n,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return"requesting"===this.state?[2]:(this.currentlyRequestingPrompt=e,this.setState("requesting"),t=this,[4,null===(n=this.pushOpsManager)||void 0===n?void 0:n.requestPermissionAndRegisterForPush(this.context)]);case 1:return t.subscriptionState=r.sent(),this.setState("ready"),[2]}}))}))},this.onPromptAccepted=function(e){return o(n,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return"unsubscribed"!==this.subscriptionState?[3,2]:[4,this.onRequestNativePrompt(e)];case 1:o.sent(),o.label=2;case 2:return[4,this.handlePromptActions(e)];case 3:return o.sent(),"subscribed"===this.subscriptionState&&(null===(n=this.ui)||void 0===n||n.showToast(null===(r=e.labels)||void 0===r?void 0:r.thanksForSubscribing)),t=this.activePrompts.indexOf(e),this.activePrompts.splice(t,1),this.render(),[2]}}))}))},this.onPromptDeclined=function(e){},this.prompts={},this.eventQueue=[],this.activePrompts=[],this.channels=[],this.uiRoot=document.createElement("div"),this.uiRoot.id="kumulos-ui-root",document.body.appendChild(this.uiRoot),this.kumulosClient=e,this.context=t,this.setState("loading"),t.subscribe("eventTracked",this.onEventTracked)}return e.prototype.handlePromptActions=function(e){return o(this,void 0,void 0,(function(){var t,n,r=this;return i(this,(function(o){switch(o.label){case 0:return e.actions?(e.actions,(t=e.actions.map((function(e){return e.channelUuid})).filter((function(e){return r.channels.find((function(t){return t.uuid===e&&!1===t.subscribed}))}))).length?[4,this.kumulosClient.getChannelSubscriptionManager().subscribe(t)]:[2]):[2];case 1:return o.sent(),n=this,[4,this.kumulosClient.getChannelSubscriptionManager().listChannels()];case 2:return n.channels=o.sent(),[2]}}))}))},e.prototype.render=function(){var e=this;this.subscriptionState&&this.state&&a.render(a.h(c.default,{ref:function(t){return e.ui=t},prompts:this.activePrompts,subscriptionState:this.subscriptionState,promptManagerState:this.state,onPromptAccepted:this.onPromptAccepted,onPromptDeclined:this.onPromptDeclined,currentlyRequestingPrompt:this.currentlyRequestingPrompt}),this.uiRoot)},e.prototype.evaluateTriggers=function(){var e=[];for(var t in this.prompts)for(var n=this.prompts[t],r=0;r<this.eventQueue.length;++r){var o=this.eventQueue[r];p.triggerMatched(n,o)&&this.promptActionNeedsTaken(n)&&e.push(n)}this.activatePrompts(e),this.eventQueue=[]},e.prototype.promptActionNeedsTaken=function(e){var t,n;if("unsubscribed"===this.subscriptionState)return!0;var r=null!==(n=null===(t=e.actions)||void 0===t?void 0:t.map((function(e){return e.channelUuid})))&&void 0!==n?n:[];return!!(this.channels.filter((function(e){return r.indexOf(e.uuid)>-1&&!e.subscribed})).length>0)},e.prototype.deferPromptActivation=function(e){!e.trigger.afterSeconds||e.trigger.afterSeconds<0||(e.trigger.afterSeconds,setTimeout(this.activateDeferredPrompt,1e3*e.trigger.afterSeconds,e))},e.prototype.activatePrompt=function(e){this.activePrompts.indexOf(e)>-1||this.activePrompts.push(e)},e.prototype.activatePrompts=function(e){for(var t=0;t<e.length;++t){var n=e[t];void 0===n.trigger.afterSeconds?this.activatePrompt(n):this.deferPromptActivation(n)}this.render()},e.prototype.setState=function(e){this.state=e,this.onEnter(e)},e.prototype.onEnter=function(e){var t;return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:switch(e){case"loading":return[3,1];case"requesting":return[3,6];case"ready":return[3,7]}return[3,9];case 1:return n=this,[4,s.default(this.context)];case 2:return n.pushOpsManager=i.sent(),[4,this.pushOpsManager.handleAutoResubscription(this.context)];case 3:return i.sent(),r=this,[4,this.pushOpsManager.getCurrentSubscriptionState(this.context)];case 4:return r.subscriptionState=i.sent(),[4,this.loadPrompts()];case 5:return i.sent(),this.setState("ready"),[3,9];case 6:return this.render(),[3,9];case 7:return this.currentlyRequestingPrompt=void 0,o=this,[4,null===(t=this.pushOpsManager)||void 0===t?void 0:t.getCurrentSubscriptionState(this.context)];case 8:return o.subscriptionState=i.sent(),this.evaluateTriggers(),this.render(),[3,9];case 9:return[2]}}))}))},e.prototype.loadPrompts=function(){var e,t;return o(this,void 0,void 0,(function(){var n,o,u,s,a,c,p;return i(this,(function(i){switch(i.label){case 0:return"auto"===this.context.pushPrompts?[3,1]:(this.prompts=r({},this.context.pushPrompts),[3,4]);case 1:return i.trys.push([1,3,,4]),n=this,[4,l.loadPromptConfigs(this.context)];case 2:return n.prompts=i.sent(),[3,4];case 3:return o=i.sent(),console.error("Failed to load prompts",o),this.prompts={},[3,4];case 4:for(s in u=[],this.prompts)u.push(s);a=0,i.label=5;case 5:if(!(a<u.length))return[3,11];if(c=u[a],!Boolean(null===(t=null===(e=this.prompts[c].actions)||void 0===e?void 0:e.filter((function(e){return"subscribeToChannel"===e.type})))||void 0===t?void 0:t.length))return[3,10];i.label=6;case 6:return i.trys.push([6,8,,9]),p=this,[4,this.kumulosClient.getChannelSubscriptionManager().listChannels()];case 7:return p.channels=i.sent(),[3,9];case 8:return i.sent(),[3,9];case 9:return[3,11];case 10:return a++,[3,5];case 11:return[2,Promise.resolve()]}}))}))},e}();t.PromptManager=f},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],u=0,s=i.length;u<s;u++,o++)r[o]=i[u];return r};t.__esModule=!0,n(16),n(18);var u=n(0),s=n(22),a=n(1);var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return u.h("div",{class:"kumulos-tooltip kumulos-tooltip-"+this.props.position},this.props.children)},t}(u.Component),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRequestNativePrompt=function(){t.props.onPromptAccepted(t.props.config)},t}return o(t,e),t.prototype.render=function(){var e,t,n,r,o,i,s,a="kumulos-prompt kumulos-prompt-"+this.props.promptManagerState+" kumulos-bell-container kumulos-bell-container-"+this.props.config.position,l=this.props.config.position.indexOf("left")>-1?"right":"left",p=null===(t=null===(e=this.props.config.colors)||void 0===e?void 0:e.bell)||void 0===t?void 0:t.bg,f=null===(r=null===(n=this.props.config.colors)||void 0===n?void 0:n.bell)||void 0===r?void 0:r.fg,d={borderColor:f,backgroundColor:p};return u.h("div",{class:a},u.h("div",{class:"kumulos-bell-inner kumulos-tooltip-parent"},u.h("div",{class:"kumulos-bell",onClick:this.onRequestNativePrompt,style:d},u.h("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},u.h("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z",fill:f}))),u.h(c,{position:l},null!==(s=null===(i=null===(o=this.props.config.labels)||void 0===o?void 0:o.tooltip)||void 0===i?void 0:i.subscribe)&&void 0!==s?s:"Subscribe for notifications")))},t}(u.Component),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.updateBlurState=function(){var e,t="kumulos-overlay-blur";("unsubscribed"===this.props.subscriptionState||document.body.classList.contains(t))&&("requesting"===this.props.promptState&&(null===(e=this.props.prompt)||void 0===e?void 0:e.overlay)?document.body.classList.add(t):document.body.classList.remove(t))},t.prototype.componentDidMount=function(){this.updateBlurState()},t.prototype.componentDidUpdate=function(){this.updateBlurState()},t.prototype.componentWillUnmount=function(){document.body.classList.remove("kumulos-overlay-blur")},t.prototype.render=function(){var e,t=this.props,n=t.promptState,r=t.prompt,o=t.subscriptionState;if(!r||"requesting"!==n||!r.overlay||"unsubscribed"!==o)return null;var i=r.overlay,s={background:i.colors.shade,color:i.colors.text};return u.h("div",{class:"kumulos-overlay kumulos-overlay-"+a.getBrowserName(),style:s},u.h("div",{class:"kumulos-overlay-strip",style:{background:i.colors.strip}},u.h("div",{class:"kumulos-overlay-content-container"},u.h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"65",height:"35",viewBox:"0 0 64 33"},u.h("path",{fill:"none",stroke:i.colors.text,"stroke-width":"2.5px","stroke-linecap":"round",d:"M 12.57,11.12\n           C 12.57,11.12 6.84,20.82 4.13,21.01\n             1.42,21.21 20.71,28.67 26.62,28.67M 4.23,21.01\n           C 4.23,21.01 53.96,14.91 60.65,3.47"})),i.iconUrl&&u.h("img",{src:i.iconUrl}),u.h("div",{class:"kumulos-overlay-content"},u.h("h3",null,i.labels.heading),u.h("p",null,i.labels.body),null===(e=i.links)||void 0===e?void 0:e.map((function(e){return u.h("a",{href:e.url,target:"_blank"},e.label)}))))))},t}(u.Component),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return u.h("div",{class:"kumulos-toast"},this.props.message)},t}(u.Component),d=function(e){function t(t){var n=e.call(this,t)||this;return n.dequeueToast=function(){n.setState({toastQueue:n.state.toastQueue.slice(1)})},n.state={toastQueue:[]},n}return o(t,e),t.prototype.showToast=function(e){e&&e.length&&(this.setState({toastQueue:i(this.state.toastQueue,[e])}),setTimeout(this.dequeueToast,3200))},t.prototype.render=function(){return s.createPortal(u.h(u.Fragment,null,this.props.prompts.map(this.renderPrompt,this),!/android|iPhone|iPad|iPod|mobile/i.test(navigator.userAgent)&&u.h(p,{promptState:this.props.promptManagerState,prompt:this.props.currentlyRequestingPrompt,subscriptionState:this.props.subscriptionState}),this.state.toastQueue.length>0&&u.h(f,{message:this.state.toastQueue[0]})),document.body)},t.prototype.renderPrompt=function(e){switch(e.type){case"bell":return u.h(l,{config:e,subscriptionState:this.props.subscriptionState,promptManagerState:this.props.promptManagerState,onPromptAccepted:this.props.onPromptAccepted,onPromptDeclined:this.props.onPromptDeclined});default:return null}},t}(u.Component);t.default=d},function(e,t,n){var r=n(17);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};n(7)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(6)(!1)).push([e.i,".kumulos-prompt{box-sizing:border-box;z-index:1000}.kumulos-prompt *,.kumulos-prompt *:before,.kumulos-prompt *:after{box-sizing:inherit}.kumulos-bell-container{position:fixed}.kumulos-bell-container-bottom-left{bottom:15px;left:15px}.kumulos-bell-container-bottom-right{bottom:15px;right:15px}.kumulos-bell{transition:transform 0.2s cubic-bezier(0.23, 1, 0.32, 1),box-shadow 0.2s cubic-bezier(0.23, 1, 0.32, 1);will-change:transform, box-shadow, width, height;border-radius:100%;border-color:#fff;background:#4c88e0;box-shadow:1px 2px 2px 0 rgba(0,0,0,0.54);width:60px;height:60px;padding:10px;transform:scale(0.9);cursor:pointer;animation:kumulos-anim-fade-in 0.2s ease-in;backface-visibility:hidden}.kumulos-bell:hover{transform:scale(1);box-shadow:1px 2px 3px 1px rgba(0,0,0,0.54)}.kumulos-bell:active{transform:scale(0.8);box-shadow:1px 2px 2px 0 rgba(0,0,0,0.54)}.kumulos-bell svg{fill:#fff;animation:kumulos-anim-shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;animation-delay:0.3s}.kumulos-bell:before{content:'';display:block;width:85%;height:85%;border:solid 1px;border-radius:100%;border-color:inherit;position:absolute;top:0;left:0;margin:7.5% 0 0 7.5%}.kumulos-bell-inner{border-radius:100%}.kumulos-tooltip-parent .kumulos-tooltip{display:none}.kumulos-tooltip-parent:hover .kumulos-tooltip{display:block}.kumulos-tooltip{background:#222;position:absolute;top:50%;padding:8px 12px;font:14px helvetica, sans-serif;color:#eee;border-radius:6px;white-space:nowrap;z-index:1100;pointer-events:none;transform:translateY(-50%);will-change:opacity, transform}.kumulos-tooltip:after{content:\"\";width:0;height:0;position:absolute;top:50%;right:100%;border:solid transparent;border-width:8px;margin-top:-8px}.kumulos-tooltip-right{left:calc(100% + 12px);animation:kumulos-reveal-right 0.2s cubic-bezier(0.23, 1, 0.32, 1)}.kumulos-tooltip-right:after{border-right-color:#222;right:100%}.kumulos-tooltip-left{right:calc(100% + 12px);animation:kumulos-reveal-left 0.2s cubic-bezier(0.23, 1, 0.32, 1)}.kumulos-tooltip-left:after{border-left-color:#222;left:100%}@keyframes kumulos-anim-shake{10%,90%{transform:translate3d(-1px, 0, 0)}20%,80%{transform:translate3d(2px, 0, 0)}30%,50%,70%{transform:translate3d(-2px, 0, 0)}40%,60%{transform:translate3d(2px, 0, 0)}}@keyframes kumulos-anim-fade-in{0%{opacity:0}100%{opacity:1}}@keyframes kumulos-reveal-left{0%{opacity:0;transform:translate(10px, -50%)}100%{opacity:1;transform:translate(0px, -50%)}}@keyframes kumulos-reveal-right{0%{opacity:0;transform:translate(-10px, -50%)}100%{opacity:1;transform:translate(0px, -50%)}}@keyframes kumulos-toast-in-out{0%{opacity:0;transform:translate3d(-50%, 100%, 0)}100%{opacity:1;transform:translateY(-50%, 0, 0)}}.kumulos-toast{display:inline-block;position:fixed;bottom:0;left:50%;transform:translateX(-50%);background:#222;z-index:1100;padding:12px;font:16px helvetica, sans-serif;color:#eee;border-radius:8px 8px 0 0;animation:kumulos-toast-in-out 0.25s cubic-bezier(0.23, 1, 0.32, 1)}\n",""]),e.exports=t},function(e,t,n){var r=n(19);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};n(7)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=n(6)(!1)).push([e.i,"body.kumulos-overlay-blur{overflow:hidden}.kumulos-overlay-blur>*:not(.kumulos-overlay){filter:blur(3px)}.kumulos-overlay{box-sizing:border-box;z-index:2000;position:fixed;top:0;left:0;height:100%;width:100%}.kumulos-overlay *,.kumulos-overlay *:before,.kumulos-overlay *:after{box-sizing:inherit}.kumulos-overlay-strip{display:flex;box-shadow:0 0 6px 0 rgba(0,0,0,0.8);min-height:150px}.kumulos-overlay-strip:before{display:block;content:'';width:calc(500px + 12%);max-width:660px}.kumulos-overlay-content-container{display:flex;max-width:38%;padding:1em;font:14px helvetica, sans-serif}.kumulos-overlay-content-container *{margin:0}.kumulos-overlay-content-container svg{margin:55px 1.7em 0 0;stroke:none;fill:rgba(0,0,0,0.8);flex-shrink:0}.kumulos-overlay-content-container img{width:55px;height:55px;flex-shrink:0}.kumulos-overlay-content-container h3,.kumulos-overlay-content-container p,.kumulos-overlay-content-container a{color:inherit}.kumulos-overlay-content-container h3{font-size:1.3em;font-weight:bold}.kumulos-overlay-content-container a{margin-right:0.65em;opacity:0.8;text-decoration:none}.kumulos-overlay .kumulos-overlay-content{margin-left:0.75em}.kumulos-overlay .kumulos-overlay-content p{margin:0.5em 0}.kumulos-overlay-chrome .kumulos-overlay-strip:before{width:440px}.kumulos-overlay-edge .kumulos-overlay-strip:before{display:none}.kumulos-overlay-edge .kumulos-overlay-strip{position:absolute;bottom:0;width:100%;padding-bottom:60px;justify-content:center}.kumulos-overlay-edge .kumulos-overlay-content-container{min-width:675px}.kumulos-overlay-edge .kumulos-overlay-content-container svg{order:1;transform:rotate(-30deg)}.kumulos-overlay-safari .kumulos-overlay-strip:before{width:calc(50% + 212px);max-width:100%}@media (max-width: 900px){body.kumulos-overlay-blur{overflow:auto}.kumulos-overlay-blur>*:not(.kumulos-overlay){filter:none}.kumulos-overlay{display:none}}\n",""]),e.exports=t},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};t.__esModule=!0,t.loadPromptConfigs=void 0;var i=n(5);t.loadPromptConfigs=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:t={},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.loadConfig(e)];case 2:return n=o.sent(),t=n.prompts,[3,4];case 3:return r=o.sent(),console.warn(r),[3,4];case 4:return[2,t]}}))}))}},function(e,t,n){"use strict";t.__esModule=!0,t.triggerMatched=void 0;var r=n(1);function o(e,t){return!!Array.isArray(e)&&("string"==typeof t?e.map((function(e){return new RegExp(r.escapeRegExp(e).replace(/\\\*/g,".*"),"g")})).reduce((function(e,n){return e||n.test(String(t))}),!1):"number"==typeof t&&e.indexOf(t)>-1)}function i(e,t){return e==t}function u(e,t){return t>e}function s(e,t){return t>=e}function a(e,t){return t<e}function c(e,t){return t<=e}t.triggerMatched=function(e,t){var n,r=e.trigger;if(r.event!==t.type)return!1;if(!(null===(n=r.filters)||void 0===n?void 0:n.length))return!0;if(!t.data)return!1;for(var l=!0,p=0;p<r.filters.length;++p){var f=r.filters[p],d=f[0],h=f[1],v=f[2],m=t.data[d],y=!1;switch(h){case"in":case"IN":y=o(v,m);break;case"=":y=i(v,m);break;case">":y=u(v,m);break;case">=":y=s(v,m);break;case"<":y=a(v,m);break;case"<=":y=c(v,m);break;default:console.warn("Unknown filter operator: "+h)}l=l&&y}return l}},function(e,t,n){"use strict";n.r(t);var r,o,i,u=n(0),s=[],a=u.options.__r,c=u.options.diffed,l=u.options.__c,p=u.options.unmount;function f(e){u.options.__h&&u.options.__h(o);var t=o.__H||(o.__H={t:[],u:[]});return e>=t.t.length&&t.t.push({}),t.t[e]}function d(e){return h(O,e)}function h(e,t,n){var i=f(r++);return i.__c||(i.__c=o,i.i=[n?n(t):O(void 0,t),function(t){var n=e(i.i[0],t);i.i[0]!==n&&(i.i[0]=n,i.__c.setState({}))}]),i.i}function v(e,t){var n=f(r++);E(n.o,t)&&(n.i=e,n.o=t,o.__H.u.push(n))}function m(e,t){var n=f(r++);E(n.o,t)&&(n.i=e,n.o=t,o.__h.push(n))}function y(e){return _((function(){return{current:e}}),[])}function b(e,t,n){m((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))}function _(e,t){var n=f(r++);return E(n.o,t)?(n.o=t,n.v=e,n.i=e()):n.i}function g(e,t){return _((function(){return e}),t)}function k(e){var t=o.context[e.__c];if(!t)return e.__;var n=f(r++);return null==n.i&&(n.i=!0,t.sub(o)),t.props.value}function w(e,t){u.options.useDebugValue&&u.options.useDebugValue(t?t(e):e)}function x(e){var t=f(r++),n=d();return t.i=e,o.componentDidCatch||(o.componentDidCatch=function(e){t.i&&t.i(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}function S(){s.some((function(e){if(e.__P)try{e.__H.u.forEach(P),e.__H.u.forEach(C),e.__H.u=[]}catch(t){return u.options.__e(t,e.m),!0}})),s=[]}function P(e){e.p&&e.p()}function C(e){var t=e.i();"function"==typeof t&&(e.p=t)}function E(e,t){return!e||t.some((function(t,n){return t!==e[n]}))}function O(e,t){return"function"==typeof t?t(e):t}function R(e,t){for(var n in t)e[n]=t[n];return e}function M(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}u.options.__r=function(e){a&&a(e),r=0,(o=e.__c).__H&&(o.__H.u.forEach(P),o.__H.u.forEach(C),o.__H.u=[])},u.options.diffed=function(e){c&&c(e);var t=e.__c;if(t){var n=t.__H;n&&n.u.length&&(1!==s.push(t)&&i===u.options.requestAnimationFrame||((i=u.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);"undefined"!=typeof window&&(t=requestAnimationFrame(n))})(S))}},u.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(P),e.__h=e.__h.filter((function(e){return!e.i||C(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],u.options.__e(n,e.m)}})),l&&l(e,t)},u.options.unmount=function(e){p&&p(e);var t=e.__c;if(t){var n=t.__H;if(n)try{n.t.forEach((function(e){return e.p&&e.p()}))}catch(e){u.options.__e(e,t.m)}}},n.d(t,"version",(function(){return te})),n.d(t,"Children",(function(){return j})),n.d(t,"render",(function(){return J})),n.d(t,"hydrate",(function(){return $})),n.d(t,"unmountComponentAtNode",(function(){return ie})),n.d(t,"createPortal",(function(){return V})),n.d(t,"createFactory",(function(){return ne})),n.d(t,"cloneElement",(function(){return oe})),n.d(t,"isValidElement",(function(){return re})),n.d(t,"findDOMNode",(function(){return ue})),n.d(t,"PureComponent",(function(){return T})),n.d(t,"memo",(function(){return A})),n.d(t,"forwardRef",(function(){return U})),n.d(t,"unstable_batchedUpdates",(function(){return se})),n.d(t,"Suspense",(function(){return W})),n.d(t,"SuspenseList",(function(){return B})),n.d(t,"lazy",(function(){return L})),n.d(t,"useState",(function(){return d})),n.d(t,"useReducer",(function(){return h})),n.d(t,"useEffect",(function(){return v})),n.d(t,"useLayoutEffect",(function(){return m})),n.d(t,"useRef",(function(){return y})),n.d(t,"useImperativeHandle",(function(){return b})),n.d(t,"useMemo",(function(){return _})),n.d(t,"useCallback",(function(){return g})),n.d(t,"useContext",(function(){return k})),n.d(t,"useDebugValue",(function(){return w})),n.d(t,"useErrorBoundary",(function(){return x})),n.d(t,"createElement",(function(){return u.createElement})),n.d(t,"createContext",(function(){return u.createContext})),n.d(t,"createRef",(function(){return u.createRef})),n.d(t,"Fragment",(function(){return u.Fragment})),n.d(t,"Component",(function(){return u.Component}));var T=function(e){var t,n;function r(t){var n;return(n=e.call(this,t)||this).isPureReactComponent=!0,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r.prototype.shouldComponentUpdate=function(e,t){return M(this.props,e)||M(this.state,t)},r}(u.Component);function A(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:M(this.props,e)}function r(t){return this.shouldComponentUpdate=n,Object(u.createElement)(e,R({},t))}return r.prototype.isReactComponent=!0,r.displayName="Memo("+(e.displayName||e.name)+")",r.t=!0,r}var N=u.options.vnode;function U(e){function t(t){var n=R({},t);return delete n.ref,e(n,t.ref)}return t.prototype.isReactComponent=!0,t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}u.options.vnode=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),N&&N(e)};var I=function(e,t){return e?Object(u.toChildArray)(e).reduce((function(e,n){return e.concat(t(n))}),[]):null},j={map:I,forEach:I,count:function(e){return e?Object(u.toChildArray)(e).length:0},only:function(e){if(1!==(e=Object(u.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:u.toChildArray},D=u.options.__e;function F(e){return e&&((e=R({},e)).__c=null,e.__k=e.__k&&e.__k.map(F)),e}function W(e){this.__u=0,this.o=null,this.__b=null}function H(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function L(e){var t,n,r;function o(o){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r;if(!n)throw t;return Object(u.createElement)(n,o)}return o.displayName="Lazy",o.t=!0,o}function B(){this.i=null,this.l=null}u.options.__e=function(e,t,n){if(e.then)for(var r,o=t;o=o.__;)if((r=o.__c)&&r.s)return r.s(e,t.__c);D(e,t,n)},(W.prototype=new u.Component).s=function(e,t){var n=this;null==n.o&&(n.o=[]),n.o.push(t);var r=H(n.__v),o=!1,i=function(){o||(o=!0,r?r(u):u())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){i(),t.__c&&t.__c()};var u=function(){var e;if(!--n.__u)for(n.__v.__k[0]=n.state.u,n.setState({u:n.__b=null});e=n.o.pop();)e.forceUpdate()};n.__u++||n.setState({u:n.__b=n.__v.__k[0]}),e.then(i,i)},W.prototype.render=function(e,t){return this.__b&&(this.__v.__k[0]=F(this.__b),this.__b=null),[Object(u.createElement)(u.Component,null,t.u?null:e.children),t.u&&e.fallback]};var q=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(B.prototype=new u.Component).u=function(e){var t=this,n=H(t.__v),r=t.l.get(e);return r[0]++,function(o){var i=function(){t.props.revealOrder?(r.push(o),q(t,e,r)):o()};n?n(i):i()}},B.prototype.render=function(e){this.i=null,this.l=new Map;var t=Object(u.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},B.prototype.componentDidUpdate=B.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,n){q(e,n,t)}))};var K=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function z(e){var t=this,n=e.container,r=Object(u.createElement)(K,{context:t.context},e.vnode);return t.h&&t.h!==n&&(t.v.parentNode&&t.h.removeChild(t.v),Object(u._unmount)(t.p),t.m=!1),e.vnode?t.m?(n.__k=t.__k,Object(u.render)(r,n),t.__k=n.__k):(t.v=document.createTextNode(""),Object(u.hydrate)("",n),n.appendChild(t.v),t.m=!0,t.h=n,Object(u.render)(r,n,t.v),t.__k=this.v.__k):t.m&&(t.v.parentNode&&t.h.removeChild(t.v),Object(u._unmount)(t.p)),t.p=r,t.componentWillUnmount=function(){t.v.parentNode&&t.h.removeChild(t.v),Object(u._unmount)(t.p)},null}function V(e,t){return Object(u.createElement)(z,{vnode:e,container:t})}var G=/^(?:accent|alignment|arabic|baseline|cap|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/;u.Component.prototype.isReactComponent={};var Q="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;function J(e,t,n){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return $(e,t,n)}function $(e,t,n){return Object(u.render)(e,t),"function"==typeof n&&n(),e?e.__c:null}var Z=u.options.event;function Y(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}u.options.event=function(e){return Z&&(e=Z(e)),e.persist=function(){},e.nativeEvent=e};var X={configurable:!0,get:function(){return this.class}},ee=u.options.vnode;u.options.vnode=function(e){e.$$typeof=Q;var t=e.type,n=e.props;if(n.class!=n.className&&(X.enumerable="className"in n,n.className&&(n.class=n.className),Object.defineProperty(n,"className",X)),"function"!=typeof t){var r,o,i;for(i in n.defaultValue&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),Array.isArray(n.value)&&n.multiple&&"select"===t&&(Object(u.toChildArray)(n.children).forEach((function(e){-1!=n.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete n.value),n)if(r=G.test(i))break;if(r)for(i in o=e.props={},n)o[G.test(i)?i.replace(/([A-Z0-9])/,"-$1").toLowerCase():i]=n[i]}!function(t){var n=e.type,r=e.props;if(r&&"string"==typeof n){var o={};for(var i in r)/^on(Ani|Tra|Tou)/.test(i)&&(r[i.toLowerCase()]=r[i],delete r[i]),o[i.toLowerCase()]=i;if(o.ondoubleclick&&(r.ondblclick=r[o.ondoubleclick],delete r[o.ondoubleclick]),o.onbeforeinput&&(r.onbeforeinput=r[o.onbeforeinput],delete r[o.onbeforeinput]),o.onchange&&("textarea"===n||"input"===n.toLowerCase()&&!/^fil|che|ra/i.test(r.type))){var u=o.oninput||"oninput";r[u]||(r[u]=r[o.onchange],delete r[o.onchange])}}}(),"function"==typeof t&&!t.g&&t.prototype&&(Y(t.prototype,"componentWillMount"),Y(t.prototype,"componentWillReceiveProps"),Y(t.prototype,"componentWillUpdate"),t.g=!0),ee&&ee(e)};var te="16.8.0";function ne(e){return u.createElement.bind(null,e)}function re(e){return!!e&&e.$$typeof===Q}function oe(e){return re(e)?u.cloneElement.apply(null,arguments):e}function ie(e){return!!e.__k&&(Object(u.render)(null,e),!0)}function ue(e){return e&&(e.base||1===e.nodeType&&e)||null}var se=function(e,t){return e(t)};t.default={useState:d,useReducer:h,useEffect:v,useLayoutEffect:m,useRef:y,useImperativeHandle:b,useMemo:_,useCallback:g,useContext:k,useDebugValue:w,version:"16.8.0",Children:j,render:J,hydrate:J,unmountComponentAtNode:ie,createPortal:V,createElement:u.createElement,createContext:u.createContext,createFactory:ne,cloneElement:oe,createRef:u.createRef,Fragment:u.Fragment,isValidElement:re,findDOMNode:ue,Component:u.Component,PureComponent:T,memo:A,forwardRef:U,unstable_batchedUpdates:se,Suspense:W,SuspenseList:B,lazy:L}}])}));